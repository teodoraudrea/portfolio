---
import { getCollection } from 'astro:content';
import type { CollectionEntry } from 'astro:content';

// Type for blog collection entries
type BlogEntry = CollectionEntry<'blog'>;

// Define the `getStaticPaths` function
export async function getStaticPaths() {
  const posts: BlogEntry[] = await getCollection('blog');
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;

if (!post) {
  throw new Error(`Blog post with slug "${Astro.params.slug}" not found.`);
}
---

<html>
  <head>
    <title>{post.data.title}</title>
  </head>
  <body>
    <h1>{post.data.title}</h1>
    <p>
      <strong>By:</strong> {post.data.author} |
      <strong>Published:</strong> {post.data.pubDate.toDateString()}
    </p>
    <article>
      {post.body}
    </article>
  </body>
</html>
